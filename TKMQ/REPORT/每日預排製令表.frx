<?xml version="1.0" encoding="utf-8"?>
<Report ScriptLanguage="CSharp" ReportInfo.Created="07/10/2024 11:46:36" ReportInfo.Modified="07/10/2024 13:43:43" ReportInfo.CreatorVersion="2016.4.4.0">
  <Dictionary>
    <MsSqlDataConnection Name="Connection" ConnectionString="rijcmlqHwzMSgwTFaHpjtG3vsOj8Zy6q+uhwpDsytgWqwZQZyEQUQyQ022aWUGqU90pHzzNjHuzu89K+RQ2LIBVx1fpgNkNJhwC4eetn2/Uy0fMrO7zDUE5AmRb+0bcYI+lxqpN+i5gA3VDGcwlcfm6L9ZMsLrZ3U+wEDtHCQtd9vw2XUFlStBzqEChNflJZ+hkKKqc">
      <TableDataSource Name="Table" DataType="System.Int32" Enabled="true" SelectCommand="SELECT MANU AS '線別' ,TC053 AS '客戶',MV002 AS '業務員',MANUDATE AS '生產日',[MB002] AS '品名',BAR AS '桶數',NUM AS '數量',PACKAGE AS '包裝數',TD001 AS '訂單',TD002 AS '訂單單號',TD003 AS '訂單序號',MOCTA001 AS '製令',MOCTA002 AS '製令號'&#13;&#10;FROM (&#13;&#10;SELECT  [MOCMANULINE].[MANU] ,CONVERT(nvarchar,[MOCMANULINE].[MANUDATE],112) MANUDATE,[MOCMANULINE].[MB002]&#13;&#10;,ISNULL([MOCMANULINE].[BAR],0) BAR,ISNULL([MOCMANULINE].[NUM],0) NUM,ISNULL([MOCMANULINE].[PACKAGE],0) PACKAGE&#13;&#10;,[MOCMANULINE].[COPTD001] AS TD001&#13;&#10;,[MOCMANULINE].[COPTD002] AS TD002&#13;&#10;,[MOCMANULINE].[COPTD003] AS TD003&#13;&#10;,[COPTC].TC053,[CMSMV].MV002&#13;&#10;,ISNULL([MOCMANULINERESULT].[MOCTA001],'') AS 'MOCTA001' &#13;&#10;,ISNULL([MOCMANULINERESULT].[MOCTA002],'') AS 'MOCTA002' &#13;&#10;,(SELECT ISNULL(SUM(TG011),0) FROM  [TK].dbo.[MOCTG] WHERE TG014=[MOCMANULINERESULT].[MOCTA001] AND TG015=[MOCMANULINERESULT].[MOCTA002])+(SELECT ISNULL(SUM(TG011),0) FROM  [TK].dbo.[MOCTG] WHERE TG014=[MOCTA].TA001 AND TG015=[MOCTA].TA002)  AS '入庫量'  &#13;&#10;,(SELECT ISNULL(SUM(TG011),0) FROM  [TK].dbo.[MOCTG] WHERE TG014=[MOCMANULINERESULT].[MOCTA001] AND TG015=[MOCMANULINERESULT].[MOCTA002]) AS '入庫量A'  &#13;&#10;,(SELECT ISNULL(SUM(TG011),0) FROM  [TK].dbo.[MOCTG] WHERE TG014=[MOCTA].TA001 AND TG015=[MOCTA].TA002)  AS '入庫量B'              &#13;&#10;,[MOCMANULINEMERGE].[NO],[MOCTA].TA033,ISNULL([MOCMANULINERESULT].[MOCTA001],'') AS MOCTA001A,ISNULL([MOCMANULINERESULT].[MOCTA002],'')  AS MOCTA002A,ISNULL([MOCTA].TA001,'')  AS MOCTA001B,ISNULL([MOCTA].TA002,'')  AS MOCTA002B  &#13;&#10;FROM [TKMOC].[dbo].[MOCMANULINE]&#13;&#10;LEFT JOIN [TK].dbo.[COPTD] ON [MOCMANULINE].[COPTD001]=[COPTD].TD001 AND [MOCMANULINE].[COPTD002]=[COPTD].TD002 AND[MOCMANULINE].[COPTD003]=[COPTD].TD003 &#13;&#10;LEFT JOIN [TK].dbo.[COPTC] ON [COPTD].TD001=[COPTC].TC001 AND [COPTD].TD002=[COPTC].TC002&#13;&#10;LEFT JOIN [TK].dbo.[CMSMV] ON [CMSMV].MV001=[COPTC].TC006&#13;&#10;LEFT JOIN [TKMOC].[dbo].[MOCMANULINERESULT] ON [MOCMANULINERESULT].[SID]=[MOCMANULINE].[ID]&#13;&#10;LEFT JOIN [TKMOC].[dbo].[MOCMANULINEMERGE] ON [MOCMANULINEMERGE].[SID]=[MOCMANULINE].[ID]  &#13;&#10;LEFT JOIN [TK].dbo.[MOCTA] ON [MOCTA].TA033=[MOCMANULINEMERGE].[NO]  &#13;&#10;WHERE CONVERT(nvarchar,[MOCMANULINE].[MANUDATE],112)&gt;='20240710' &#13;&#10;AND [MOCMANULINE].[MB001] NOT IN (SELECT MB001 FROM  [TKMOC].[dbo].[MOCMANULINELIMITBARCOUNT])&#13;&#10;UNION ALL  &#13;&#10;SELECT  [MOCMANULINETEMP].[MANU] ,CONVERT(nvarchar,dateadd(ms,-3,dateadd(yy, datediff(yy,0,getdate())+2, 0)) ,112) MANUDATE,[MOCMANULINETEMP].[MB002]&#13;&#10;,ISNULL([MOCMANULINETEMP].[BAR],0) BAR,ISNULL([MOCMANULINETEMP].[NUM],0) NUM,ISNULL([MOCMANULINETEMP].[PACKAGE],0) PACKAGE&#13;&#10;,[MOCMANULINETEMP].[COPTD001] AS TD001&#13;&#10;,[MOCMANULINETEMP].[COPTD002] AS TD002&#13;&#10;,[MOCMANULINETEMP].[COPTD003] AS TD003&#13;&#10;,[COPTC].TC053,[CMSMV].MV002&#13;&#10;,ISNULL([MOCMANULINERESULT].[MOCTA001],'') AS 'MOCTA001' &#13;&#10;,ISNULL([MOCMANULINERESULT].[MOCTA002],'') AS 'MOCTA002' &#13;&#10;,(SELECT ISNULL(SUM(TG011),0) FROM  [TK].dbo.[MOCTG] WHERE TG014=[MOCMANULINERESULT].[MOCTA001] AND TG015=[MOCMANULINERESULT].[MOCTA002])+(SELECT ISNULL(SUM(TG011),0) FROM  [TK].dbo.[MOCTG] WHERE TG014=[MOCTA].TA001 AND TG015=[MOCTA].TA002)  AS '入庫量'  &#13;&#10;,(SELECT ISNULL(SUM(TG011),0) FROM  [TK].dbo.[MOCTG] WHERE TG014=[MOCMANULINERESULT].[MOCTA001] AND TG015=[MOCMANULINERESULT].[MOCTA002]) AS '入庫量A'  &#13;&#10;,(SELECT ISNULL(SUM(TG011),0) FROM  [TK].dbo.[MOCTG] WHERE TG014=[MOCTA].TA001 AND TG015=[MOCTA].TA002)  AS '入庫量B'  &#13;&#10;,[MOCMANULINEMERGE].[NO],[MOCTA].TA033,ISNULL([MOCMANULINERESULT].[MOCTA001],'') AS MOCTA001A,ISNULL([MOCMANULINERESULT].[MOCTA002],'')  AS MOCTA002A,ISNULL([MOCTA].TA001,'')  AS MOCTA001B,ISNULL([MOCTA].TA002,'')  AS MOCTA002B  &#13;&#10;FROM [TKMOC].[dbo].[MOCMANULINETEMP]  &#13;&#10;LEFT JOIN [TK].dbo.[COPTD] ON [MOCMANULINETEMP].[COPTD001]=[COPTD].TD001 AND [MOCMANULINETEMP].[COPTD002]=[COPTD].TD002 AND[MOCMANULINETEMP].[COPTD003]=[COPTD].TD003   &#13;&#10;LEFT JOIN [TK].dbo.[COPTC] ON [COPTD].TD001=[COPTC].TC001 AND [COPTD].TD002=[COPTC].TC002  &#13;&#10;LEFT JOIN [TK].dbo.[CMSMV] ON [CMSMV].MV001=[COPTC].TC006  &#13;&#10;LEFT JOIN [TKMOC].[dbo].[MOCMANULINE] ON [MOCMANULINE].ID=[MOCMANULINETEMP].TID  &#13;&#10;LEFT JOIN [TKMOC].[dbo].[MOCMANULINERESULT] ON [MOCMANULINERESULT].[SID]=[MOCMANULINE].[ID]  &#13;&#10;LEFT JOIN [TKMOC].[dbo].[MOCMANULINEMERGE] ON [MOCMANULINEMERGE].[SID]=[MOCMANULINE].[ID]  &#13;&#10;LEFT JOIN [TK].dbo.[MOCTA] ON [MOCTA].TA033=[MOCMANULINEMERGE].[NO]  &#13;&#10;WHERE CONVERT(nvarchar,[MOCMANULINETEMP].[MANUDATE],112)&gt;='20240710' &#13;&#10;AND [MOCMANULINETEMP].TID IS NULL  &#13;&#10;AND [MOCMANULINE].[MB001] NOT IN (SELECT MB001 FROM  [TKMOC].[dbo].[MOCMANULINELIMITBARCOUNT])&#13;&#10;) AS TEMP&#13;&#10;ORDER BY  TEMP.[MANU],CONVERT(nvarchar, TEMP.[MANUDATE],112)    ">
        <Column Name="線別" DataType="System.String"/>
        <Column Name="客戶" DataType="System.String"/>
        <Column Name="業務員" DataType="System.String"/>
        <Column Name="生產日" DataType="System.String"/>
        <Column Name="品名" DataType="System.String"/>
        <Column Name="桶數" DataType="System.Decimal"/>
        <Column Name="數量" DataType="System.Decimal"/>
        <Column Name="包裝數" DataType="System.Decimal"/>
        <Column Name="訂單" DataType="System.String"/>
        <Column Name="訂單單號" DataType="System.String"/>
        <Column Name="訂單序號" DataType="System.String"/>
        <Column Name="製令" DataType="System.String"/>
        <Column Name="製令號" DataType="System.String"/>
      </TableDataSource>
    </MsSqlDataConnection>
  </Dictionary>
  <ReportPage Name="Page1" Landscape="true" PaperWidth="400" PaperHeight="210">
    <ReportTitleBand Name="ReportTitle1" Width="1436.4" Height="18.9">
      <TextObject Name="Text1" Width="217.35" Height="18.9" Text="每日預排製令表" HorzAlign="Center" VertAlign="Center"/>
    </ReportTitleBand>
    <PageHeaderBand Name="PageHeader1" Top="23.5" Width="1436.4" Height="18.9">
      <TextObject Name="Text3" Width="66.15" Height="18.9" Border.Lines="All" Text="線別" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text11" Left="604.8" Width="321.3" Height="18.9" Border.Lines="All" Text="品名" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text13" Left="926.1" Width="75.6" Height="18.9" Border.Lines="All" Text="桶數" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text15" Left="1001.7" Width="75.6" Height="18.9" Border.Lines="All" Text="數量" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text17" Left="1077.3" Width="75.6" Height="18.9" Border.Lines="All" Text="包裝數" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text19" Left="1152.9" Width="94.5" Height="18.9" Border.Lines="All" Text="訂單" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text21" Left="1247.4" Width="94.5" Height="18.9" Border.Lines="All" Text="訂單單號" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text27" Left="1341.9" Width="94.5" Height="18.9" Border.Lines="All" Text="訂單序號" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text5" Left="66.15" Width="189" Height="18.9" Border.Lines="All" Text="客戶" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text7" Left="255.15" Width="94.5" Height="18.9" Border.Lines="All" Text="業務員" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text9" Left="349.65" Width="94.5" Height="18.9" Border.Lines="All" Text="生產日" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text23" Left="444.15" Width="66.15" Height="18.9" Border.Lines="All" Text="製令" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text25" Left="510.3" Width="94.5" Height="18.9" Border.Lines="All" Text="製令號" HorzAlign="Center" VertAlign="Center"/>
    </PageHeaderBand>
    <DataBand Name="Data1" Top="47" Width="1436.4" Height="18.9" CanGrow="true" DataSource="Table">
      <TextObject Name="Text2" Width="66.15" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.線別]" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text10" Left="604.8" Width="321.3" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.品名]" VertAlign="Center"/>
      <TextObject Name="Text12" Left="926.1" Width="75.6" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.桶數]" Format="Number" Format.UseLocale="false" Format.DecimalDigits="0" Format.DecimalSeparator="." Format.GroupSeparator="," Format.NegativePattern="1" HorzAlign="Right" VertAlign="Center" WordWrap="false" Trimming="EllipsisCharacter"/>
      <TextObject Name="Text14" Left="1001.7" Width="75.6" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.數量]" Format="Number" Format.UseLocale="false" Format.DecimalDigits="0" Format.DecimalSeparator="." Format.GroupSeparator="," Format.NegativePattern="1" HorzAlign="Right" VertAlign="Center" WordWrap="false" Trimming="EllipsisCharacter"/>
      <TextObject Name="Text16" Left="1077.3" Width="75.6" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.包裝數]" Format="Number" Format.UseLocale="false" Format.DecimalDigits="0" Format.DecimalSeparator="." Format.GroupSeparator="," Format.NegativePattern="1" HorzAlign="Right" VertAlign="Center" WordWrap="false" Trimming="EllipsisCharacter"/>
      <TextObject Name="Text18" Left="1152.9" Width="94.5" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.訂單]" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text20" Left="1247.4" Width="94.5" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.訂單單號]" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text26" Left="1341.9" Width="94.5" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.訂單序號]" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text4" Left="66.15" Width="189" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.客戶]" VertAlign="Center"/>
      <TextObject Name="Text6" Left="255.15" Width="94.5" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.業務員]" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text8" Left="349.65" Width="94.5" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.生產日]" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text22" Left="444.15" Width="66.15" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.製令]" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text24" Left="510.3" Width="94.5" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.製令號]" HorzAlign="Center" VertAlign="Center"/>
    </DataBand>
    <PageFooterBand Name="PageFooter1" Top="70.49" Width="1436.4" Height="18.9"/>
  </ReportPage>
</Report>
